# ğŸš€ éƒ¨ç½²åˆ°æœåŠ¡å™¨æŒ‡å—

> **æ—¥æœŸ**: 2025-11-09  
> **ç›®çš„**: éƒ¨ç½²ç™»å½•æƒé™åŠŸèƒ½åˆ°ç”Ÿäº§ç¯å¢ƒ

---

## âš ï¸ **é‡è¦æç¤º**

**å½“å‰é—®é¢˜**: æ–°çš„ç™»å½•é™åˆ¶ä»£ç è¿˜åœ¨æœ¬åœ°ï¼Œç”Ÿäº§ç¯å¢ƒè¿˜æ˜¯æ—§ç‰ˆæœ¬ï¼

**å½±å“**: ç”¨æˆ·è®¿é—® `https://app7626.acapp.acwing.com.cn` çœ‹åˆ°çš„è¿˜æ˜¯æ—§ä»£ç ï¼Œæœªç™»å½•ä»å¯åˆ›å»ºäº‹ä»¶ã€‚

**è§£å†³æ–¹æ¡ˆ**: éœ€è¦éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼

---

## ğŸ“‹ **éƒ¨ç½²æ­¥éª¤**

### **æ–¹æ³• 1: é€šè¿‡ SSH éƒ¨ç½²ï¼ˆæ¨èï¼‰**

```bash
# 1. SSH ç™»å½•æœåŠ¡å™¨
ssh acs@app7626.acapp.acwing.com.cn
# å¯†ç ï¼šï¼ˆä½ çš„æœåŠ¡å™¨å¯†ç ï¼‰

# 2. è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/kotlin_calendar

# 3. æ‹‰å–æœ€æ–°ä»£ç 
git pull

# 4. æ£€æŸ¥ä»£ç æ›´æ–°
git log --oneline -5

# 5. æ„å»ºå‰ç«¯ï¼ˆå¦‚æœæœåŠ¡å™¨ä¸Šæœ‰ Node.jsï¼‰
cd web_frontend
npm install  # å¦‚æœæœ‰æ–°ä¾èµ–
npm run build

# 6. åˆ·æ–°æµè§ˆå™¨ç¼“å­˜
# è®©ç”¨æˆ·æŒ‰ Ctrl+Shift+R å¼ºåˆ¶åˆ·æ–°
```

---

### **æ–¹æ³• 2: åªéƒ¨ç½²æ„å»ºäº§ç‰©ï¼ˆæ›´å¿«ï¼‰**

å¦‚æœæœåŠ¡å™¨ä¸Šæ²¡æœ‰ Node.js æˆ–æ„å»ºå¾ˆæ…¢ï¼Œå¯ä»¥åœ¨æœ¬åœ°æ„å»ºåä¸Šä¼ ï¼š

```bash
# 1. æœ¬åœ°æ„å»ºï¼ˆå·²å®Œæˆï¼‰
cd web_frontend
npm run build
# âœ… æ„å»ºäº§ç‰©åœ¨ ../web/ ç›®å½•

# 2. ä½¿ç”¨ SCP ä¸Šä¼ æ„å»ºäº§ç‰©
scp -r web/* acs@app7626.acapp.acwing.com.cn:~/kotlin_calendar/web/

# 3. SSH ç™»å½•æ£€æŸ¥
ssh acs@app7626.acapp.acwing.com.cn
cd ~/kotlin_calendar/web
ls -la assets/
# åº”è¯¥çœ‹åˆ°æ–°çš„æ–‡ä»¶ï¼š
# - index-C78v9__L.js  (æ–°)
# - vue-vendor-CcdHNNDt.js  (æ–°)
# - fullcalendar-BV5f0vVo.js  (æ–°)
# - element-plus-BulleSUT.js  (æ–°)
```

---

### **æ–¹æ³• 3: é€šè¿‡ Git åŒæ­¥ï¼ˆæœ€ç®€å•ï¼‰**

```bash
# åœ¨æœåŠ¡å™¨ä¸Š
cd ~/kotlin_calendar
git pull
# âœ… ä»£ç å·²æ›´æ–°

# å‰ç«¯é™æ€æ–‡ä»¶å·²åœ¨ web/ ç›®å½•ï¼Œç›´æ¥åˆ·æ–°æµè§ˆå™¨å³å¯
```

---

## âœ… **éªŒè¯éƒ¨ç½²æ˜¯å¦æˆåŠŸ**

### **1. æ£€æŸ¥æ–‡ä»¶æ›´æ–°**

```bash
# åœ¨æœåŠ¡å™¨ä¸Š
ls -lh ~/kotlin_calendar/web/assets/

# åº”è¯¥çœ‹åˆ°æ–°æ–‡ä»¶ï¼ˆæ–‡ä»¶å“ˆå¸Œï¼‰:
# index-C78v9__L.js  (æœ€æ–°)
# vue-vendor-CcdHNNDt.js  (æœ€æ–°)
```

### **2. æµè§ˆå™¨æµ‹è¯•**

```bash
# 1. æ‰“å¼€æµè§ˆå™¨æ— ç—•æ¨¡å¼ï¼ˆé¿å…ç¼“å­˜ï¼‰
# 2. è®¿é—®: https://app7626.acapp.acwing.com.cn
# 3. å°è¯•ç‚¹å‡»å³ä¸‹è§’çš„æµ®åŠ¨æŒ‰é’®
```

**é¢„æœŸç»“æœ** âœ…:
- æœªç™»å½•æ—¶ï¼Œå³ä¸‹è§’æ˜¾ç¤º"ç™»å½•"æŒ‰é’®ï¼ˆä¸æ˜¯"+"æŒ‰é’®ï¼‰
- ç‚¹å‡»åå¼¹å‡ºæç¤ºï¼š"åˆ›å»ºäº‹ä»¶éœ€è¦ç™»å½•ï¼Œè¯·å…ˆç™»å½•"
- 3 ç§’åè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ

### **3. åŠŸèƒ½æ£€æŸ¥æ¸…å•**

| åŠŸèƒ½ | æœªç™»å½•é¢„æœŸ | ç™»å½•åé¢„æœŸ |
|------|----------|----------|
| ä¾§è¾¹æ æ ‡ç­¾ | åªæœ‰"è¿åŠ¿"å’Œ"èŠ‚æ—¥" | æœ‰"æ—¥ç¨‹"ã€"è¿åŠ¿"ã€"èŠ‚æ—¥" |
| æµ®åŠ¨æŒ‰é’® | æ˜¾ç¤º"ç™»å½•" | æ˜¾ç¤º"+" |
| å·¥å…·æ  | ä¸æ˜¾ç¤º | æ˜¾ç¤ºï¼ˆæ¡Œé¢ç«¯ï¼‰ |
| ç‚¹å‡»æ—¥æœŸ | æç¤ºç™»å½• | åˆ‡æ¢åˆ°æ—¥ç¨‹åˆ—è¡¨ |
| ç‚¹å‡»äº‹ä»¶ | æç¤ºç™»å½• | æ˜¾ç¤ºè¯¦æƒ… |
| åˆ›å»ºäº‹ä»¶ | æç¤ºç™»å½• | æ‰“å¼€åˆ›å»ºå¯¹è¯æ¡† |

---

## ğŸ› **å¦‚æœéƒ¨ç½²åè¿˜æœ‰é—®é¢˜**

### **é—®é¢˜ 1: æµè§ˆå™¨ä»æ˜¾ç¤ºæ—§ç‰ˆæœ¬**

**åŸå› **: æµè§ˆå™¨ç¼“å­˜

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ¸…é™¤ç¼“å­˜æ–¹æ³•ï¼ˆæŒ‰é‡è¦æ€§æ’åºï¼‰ï¼š
1. Ctrl + Shift + R (å¼ºåˆ¶åˆ·æ–°)
2. å¼€å‘è€…å·¥å…· â†’ Network â†’ Disable cache
3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å’Œ Cookie
4. ä½¿ç”¨æ— ç—•æ¨¡å¼æµ‹è¯•
```

### **é—®é¢˜ 2: 401 Unauthorized é”™è¯¯**

**åŸå› **: è¿™æ˜¯**æ­£å¸¸çš„**ï¼æœªç™»å½•æ—¶å‰ç«¯ä»ä¼šå°è¯•è·å–ç”¨æˆ·ä¿¡æ¯ã€‚

**ç°è±¡**:
```
api/auth/me/:1  Failed to load resource: 401 (Unauthorized)
```

**è¯´æ˜**: 
- è¿™ä¸ªè¯·æ±‚æ¥è‡ª `NavBar.vue` çš„ `fetchCurrentUser()`
- 401 é”™è¯¯ä¼šè¢«é™é»˜å¤„ç†ï¼ˆcatch å—ï¼‰
- ä¸å½±å“åŠŸèƒ½ï¼Œåªæ˜¯åå°æ—¥å¿—

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼ˆå¯é€‰ï¼‰:
```javascript
// åœ¨ NavBar.vue ä¸­
const fetchCurrentUser = async () => {
  const token = localStorage.getItem('access_token')
  if (!token) {
    currentUser.value = null
    return  // âœ… æ²¡æœ‰ token å°±ä¸è¯·æ±‚
  }
  
  try {
    const user = await authAPI.getCurrentUser()
    currentUser.value = user
  } catch (error) {
    currentUser.value = null
  }
}
```

### **é—®é¢˜ 3: 500 Internal Server Error**

**åŸå› **: åç«¯é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ£€æŸ¥åç«¯æ—¥å¿—
tail -f ~/kotlin_calendar/backend/logs/django.log

# 2. æ£€æŸ¥ uWSGI çŠ¶æ€
ps aux | grep uwsgi

# 3. é‡å¯åç«¯æœåŠ¡
cd ~/kotlin_calendar/backend
pkill -f uwsgi
uwsgi --ini uwsgi.ini &
```

---

## ğŸ”„ **åç»­æ›´æ–°æµç¨‹**

ä»¥åæ¯æ¬¡ä¿®æ”¹ä»£ç åï¼š

```bash
# æœ¬åœ°
cd web_frontend
npm run build
git add ../web/
git commit -m "build: update frontend"
git push

# æœåŠ¡å™¨
ssh acs@app7626.acapp.acwing.com.cn
cd ~/kotlin_calendar
git pull
# âœ… å®Œæˆï¼åˆ·æ–°æµè§ˆå™¨å³å¯
```

---

## ğŸ“ **éƒ¨ç½²æ£€æŸ¥æ¸…å•**

- [ ] ä»£ç å·²æ¨é€åˆ° GitHub
- [ ] æœåŠ¡å™¨å·²æ‰§è¡Œ `git pull`
- [ ] æµè§ˆå™¨å·²å¼ºåˆ¶åˆ·æ–°ï¼ˆCtrl+Shift+Rï¼‰
- [ ] æœªç™»å½•æ—¶çœ‹åˆ°"ç™»å½•"æŒ‰é’®
- [ ] ç‚¹å‡»åæœ‰ç™»å½•æç¤º
- [ ] ç™»å½•ååŠŸèƒ½æ­£å¸¸
- [ ] ä¾§è¾¹æ æ ‡ç­¾æ­£ç¡®æ˜¾ç¤º

---

## ğŸ¯ **æœ¬æ¬¡éƒ¨ç½²å†…å®¹**

### **Commit 1**: ä¸»è¦åŠŸèƒ½å®ç°
```
feat: add authentication requirement for event management

- ä¾§è¾¹æ æ ‡ç­¾åŠ¨æ€æ˜¾ç¤º
- æµ®åŠ¨æŒ‰é’®æ¡ä»¶æ¸²æŸ“
- äº‹ä»¶åŠ è½½é€»è¾‘ä¼˜åŒ–
- ç™»å½•å¼•å¯¼æç¤º
```

### **Commit 2**: ä¿®å¤è®¤è¯é€»è¾‘
```
fix: unify authentication logic across all event operations

- ç»Ÿä¸€ useCalendarEvents.js çš„ç™»å½•æ£€æŸ¥
- æ‰€æœ‰äº‹ä»¶æ“ä½œéƒ½å—ä¿æŠ¤
- ä¸€è‡´çš„ç”¨æˆ·ä½“éªŒ
```

---

## ğŸš€ **å¿«é€Ÿéƒ¨ç½²å‘½ä»¤**

```bash
# ä¸€é”®éƒ¨ç½²ï¼ˆåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼‰
ssh acs@app7626.acapp.acwing.com.cn << 'EOF'
cd ~/kotlin_calendar
git pull
echo "âœ… ä»£ç å·²æ›´æ–°ï¼è¯·åˆ·æ–°æµè§ˆå™¨ï¼ˆCtrl+Shift+Rï¼‰"
EOF
```

---

**å®Œæˆååˆ é™¤æ­¤æ–‡ä»¶**: `rm DEPLOY_TO_SERVER.md`

---

**ç¥éƒ¨ç½²é¡ºåˆ©ï¼** ğŸ‰

